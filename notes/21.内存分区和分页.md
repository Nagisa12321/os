## 内存的分区和分页

- 将代码段和数据段放到内存中
- 取指执行, 把逻辑地址转换为物理地址

- ldtr是存放ldt表起始地址的寄存器, 也会存放在进程的ocb之中, 当进程被调度到的时候, 会把这个进程的ldtr加载到当前寄存器, 那么cpu就能去到进程对应的ldt表根据选择子选出合适的地址

1. 分段
2. 找出空闲分区
3. 将映射表做好


### 如何在内存中找出空闲区域? 
1. 固定分区
2. 可变分区
   - 维护空闲分区表和已分配分区表 
   - 选取什么分区给段请求?
        1. 最佳适配
        2. 最差适配
        3. 首先适配

### 为什么要有分页, 分段不是已经足够了吗? 
- 分区的效率不高, 很多内存碎片
- 内存够但却放不进去!!!!
- 可以使用内存紧缩进行内存移动, 不过耗费时间...


- 利用mem_map[] 将内存分页!
- 以页为单位分配内存
- 不用进行内存紧缩! 内存浪费很少

- 物理内存需要分页
- 用户需要分段

### 页已经载入内存, 怎么让程序跑起来? 
- 维护"页表"
- 页表地址寄存器 -- cr3
- 根据逻辑地址算出是那一页, 算出偏移量
- 然后去页表中通过 页号拿出页框号
- 通过页框号我们就可以拿出物理地址起始地址, 然后再加上偏移量, 就真正得出物理地址

- MMU: 内存管理单元